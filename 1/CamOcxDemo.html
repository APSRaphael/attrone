<html>

	<head>
		<!--<meta http-equiv="Content-Type" content="text/html; charset=gb2312">-->
        <meta http-equiv="X-UA-Compatible" content="IE=10"/>
		<title>SDK 演示</title>
<script >


var CamID  = -1;  //此例程默认以第一个摄像头打开
var SupportFormat;    //设备支持的视频格式代号：1->MJPG; 2->YUY2 
var OpenFormat;      //打开格式：0->YUY；1->MJPG
var isOpen = false;
var isWiseCapture =false;

var nFileCount = 0;
var bAdjustMode = 0;
var bCropArea = 0;
var bSeriesCapture = 0;
var bReadBarCode=0;
var bSetDenoise = 0;
var Width = 0;
var Height = 0;
var strFile;
var index = 0;
var strCardFile;
var cardIndex = 0;
var captureCount = 0;
function loadActiveX() {

    if ((navigator.userAgent.indexOf('MSIE') >= 0) && (navigator.userAgent.indexOf('Opera') < 0)) {
         //IE浏览器加载控件
        document.getElementById("ActiveXDivOne").innerHTML = "<OBJECT id=\"axCam_Ocx\"  classid=\"clsid:CE2D72F2-AD28-4013-A24B-C3F76C5A1944\" width=\"100%\" height=\"544px\" ></OBJECT>";
    }
    else {
        //其他浏览器加载控件
        document.getElementById("ActiveXDivOne").innerHTML = "<OBJECT id=\"axCam_Ocx\" type=\"application/x-camera\"  clsid=\"{CE2D72F2-AD28-4013-A24B-C3F76C5A1944}\"  width=\"100%\" height=\"544px\" ></OBJECT>";
     }
}
//开启摄像头
function StartVideo() 
{
    var i = axCam_Ocx.CAM_Open(0, 1, '3264', '2448');
}

//抓图拍照
function Capture() {
    captureCount = captureCount + 1;
    var path = "D:\\Img_" + captureCount;
    var suffix = ".jpg";
    path = path + suffix;
    var baseStr=axCam_Ocx.CaptureImage(path);
}
//获取设备;
function GetDevice() {

    var i = 0;
    var devCount = axCam_Ocx.GetDevCount();
    var obj = document.getElementById("DeviceName");
    
    for (i = 0; i < devCount; i++) 
    {
        var DevName = axCam_Ocx.GetDevFriendName(i);
        var objOption = document.createElement("option");
        objOption.text = DevName;
        objOption.value = i;
        obj.options.add(objOption);
    }
    if (devCount > 0) {

        CamID = axCam_Ocx.GetMainCameraID();   //获取主摄像头ID
        if (CamID < 0) {
            alert("没有主头设备");
            obj.value = 0;
        }
        else {
            obj.value = CamID;
         }
    }  

    var FormatSum  = 0;  //设备支持的视频格式代号总和
    var scount  = axCam_Ocx.GetFormatCount(CamID);   //获取设备支持的视频格式数目
    for (var k = 0; k < scount; k++)
    {
            FormatSum = FormatSum + axCam_Ocx.GetFormatNumber(k);    //GetFormatNumber（）获取设备支持的视频格式代号
    }
               
    //判断视频格式代号总和的值
    switch(FormatSum)
    {
        case 1:   //（设备只支持MJPG格式）
            OpenFormat = 1 ;     //打开格式为MJPG
            SupportFormat = 1;
            break;
        case 2:   //（设备只支持YUY2格式）
            OpenFormat = 0 ;     //打开格式为YUY
            SupportFormat = 2;
            break;
        case 3:   //（设备支持MJPG与YUY2两种格式）
            OpenFormat = 1 ;     //默认打开格式为MJPG
            SupportFormat = 1;
            break;
    }

    GetDeviceResolution();  //获取分辨率

    var filetypeobj = document.getElementById("FileType");
    filetypeobj.value = 1;
}
//获取分辨率
function GetDeviceResolution() 
{
    var i = 0;
    var resCount = axCam_Ocx.GetResolutionCount(CamID, SupportFormat); //获取设备支持的分辨率数目
    var obj = document.getElementById("Resolution");
    for (i = 0; i < resCount; i++) {
        var mResolution = axCam_Ocx.GetResolution(i);
        var objOption = document.createElement("option");
        objOption.text = mResolution;
        objOption.value = i;
        obj.options.add(objOption);
    }
    if (resCount > 0) obj.value = 0;
}
setTimeout(function(){
	StartVideo() ;//默认打开摄像头
	axCam_Ocx.SetAutoCut(1);
},1000);
</script>

<script type="text/javascript" for="axCam_Ocx" event="GetImageFileName(fileName);"> </script>

<style type="text/css">
    #Text1
    {
        width: 197px;
        margin-left: 6px;
    }
    #DeviceName
    {
        width: 175px;
    }
    .style1
    {
        width: 175px;
    }
    .style3
    {
        width: 175px;
        height: 20px;
    }
    .style5
    {
        height: 20px;
        width: 69px;
    }
    #Select1
    {
        width: 76px;
    }
    #Select2
    {
        width: 158px;
    }
    #Resolution
    {
        width: 176px;
    }
    #Button1
    {
        width: 64px;
        height: 25px;
    }
    #Button2
    {
        height: 25px;
        width: 63px;
    }
    #Button3
    {
        height: 57px;
        width: 103px;
    }
    .style11
    {
        width: 12px;
    }
    .style12
    {
        width: 38px;
    }
    .style13
    {
        width: 72px;
    }
    .style14
    {
        width: 150px;
    }
    #FileType
    {
        width: 158px;
    }
    #ColourMode
    {
        width: 158px;
    }
    #Button4
    {
        height: 25px;
    }
    #Radio1
    {
        margin-bottom: 0px;
    }
    #Button5
    {
        height: 25px;
    }
    .style15
    {
        height: 27px;
    }
    .style16
    {
        width: 67px;
    }
    #Text2
    {
        width: 75px;
    }
    .style17
    {
        width: 41px;
    }
    #Text4
    {
        width: 75px;
    }
    #Text3
    {
        width: 77px;
    }
    #File1
    {
        width: 242px;
    }
    #Button6
    {
        width: 242px;
    }
    #Text6
    {
        height: 148px;
        width: 155px;
    }
    #TextArea1
    {
        height: 144px;
    }
    .style19
    {
        width: 74px;
    }
    #URL
    {
        width: 168px;
    }
    .style20
    {
        width: 131px;
    }
    </style>

</head>

	<body onload ="loadActiveX();GetDevice();">

        <div style="width:320px; height: 590px; background:#C7EDCC; border: 1px solid black;float:left">
            <div style="width: 100%;height: 80%;">

                <img id="img1" alt="" src="" style="width: 99%;height: 40%" />

                <div style="width: 99%;height: 50%" id='ActiveXDivTwo'>
                </div>

                 <input  type="button" value="打开副头" onclick = "StartVideo2();"/>   
                 <input  type="button" value="关闭副头" onclick = "CloseVideo2();"/>   
                 <input  type="button" value="拍照" onclick = "Capture2();"/>            
                
            </div> 
            <div style="width: 100%;height: 20%;">
                <textarea id="TextArea1" cols="20" rows="2" style="width: 100%;height:100%;">
                </textarea> 
             </div>
        </div>

        <div style="width:600px; height: 590px; border: 1px solid black; background:#C7EDCC;  float:left">

                <div  width="100%" height="544px" id='ActiveXDivOne'>
		        </div>	
        </div>


        <div style="width:260px;height:590px;background:#C7EDCC; border: 1px solid black;float:left">
                    <table style="width:100%;">
                        <tr>
                            <td class="style5" style="font-size: medium">
                                设备</td>
                            <td class="style1">
                                <select id="DeviceName" name="D1"onchange = "ChangeDevice()">
                                </select></td>
                        </tr>
                        <tr>
                            <td class="style5" style="font-size: medium">
                                分辨率</td>
                            <td class="style3">
                                <select id="Resolution" name="D2"onchange = "ChangeResolution()">
                                </select></td>
                        </tr>
                    </table>

                    <table style="border: 1px; width:100%; height: 67px;">
                        <tr>
                            <td class="style11" >
                                <input id="Button1" type="button" value="打开" onclick = "StartVideo();"/></td>
                            <td rowspan="2" class="style12">
                                <input id="Button3" type="button" value="拍照" onclick = "Capture();"/></td>
                            <td class="style11" >
                                <input id="Button5" type="button" value="智能连拍" onclick = "WiseCapture();"/></td>
                        </tr>
                        <tr>
                            <td class="style11" >
                                <input id="Button2" type="button" value="关闭" onclick = "CloseVideo();"/></td>      
                            <td  class="style11">
                                 <input id="Button4" type="button" value="参数设置" onclick = "ShowImageSettingWindow();" /></td>
                        </tr>

                    </table>



                     <hr/><!-- 分割线-->

                    <hr/><!-- 分割线-->

                    

                             
		
	</body>

</html>